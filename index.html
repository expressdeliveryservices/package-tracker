<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Express Delivery Service</title>
<style>
/* --- Layout & theme (keeps your original look) --- */
:root{--brand:#1e90ff;}
body{margin:0;font-family:Arial,sans-serif;background:#fff;color:#000;scroll-behavior:smooth;}
a{color:var(--brand);text-decoration:none;}
h1,h2,h3,h4{color:var(--brand);margin:0;}
header{position:relative;height:380px;overflow:hidden;}
header video{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;pointer-events:none;}
.header-overlay{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;z-index:2;color:#fff;text-shadow:2px 2px 8px rgba(0,0,0,0.6);padding:0 20px;}
.header-overlay h1{font-size:2.2rem;letter-spacing:1px}
.navbar{display:flex;justify-content:space-between;align-items:center;padding:12px;background:#f8f8f8;position:sticky;top:0;z-index:1000;border-bottom:1px solid #ddd;}
.nav-links{display:flex;gap:12px;align-items:center;}
.nav-links a{cursor:pointer;font-weight:bold;color:var(--brand);}
.hamburger{display:none;cursor:pointer;padding:6px;}
.hamburger div{width:22px;height:2px;background:var(--brand);margin:4px 0;transition:0.25s;}
@media(max-width:820px){.nav-links{display:none;flex-direction:column;position:absolute;right:12px;top:60px;background:#fff;padding:12px;border-radius:6px;box-shadow:0 6px 18px rgba(0,0,0,0.08);} .hamburger{display:block}}
.section{padding:20px;scroll-margin-top:64px;max-width:1100px;margin:0 auto;}
.section-title{font-size:1.4rem;margin-bottom:12px;color:var(--brand);}

/* Tracking & details */
.tracking{display:flex;gap:10px;margin-bottom:14px;}
.tracking input{flex:1;padding:8px;border:1px solid #ddd;border-radius:4px;background:#fff;font-size:0.95rem;}
.tracking button{padding:8px 14px;border:none;border-radius:4px;background:var(--brand);color:#fff;cursor:pointer}

/* panels */
.shipment-tracking,.shipment-content{max-width:900px;margin:12px auto;padding:14px;border:1px solid #000;background:#fff;font-family:'Courier New',Courier,monospace;font-size:13px;}
.timeline{position:relative;margin:10px 0;}
.timeline::before{content:'';position:absolute;left:20px;top:0;bottom:0;width:4px;background:#ddd;}
.timeline-event{position:relative;margin-bottom:18px;padding-left:56px;}
.timeline-event .tick{position:absolute;left:12px;top:0;width:24px;height:24px;border-radius:50%;border:4px solid var(--brand);background:#fff;}
.timeline-event.completed .tick{background:var(--brand);box-shadow:0 0 6px rgba(30,144,255,0.25);}
.timeline-event .time{font-size:0.85rem;color:#0a58ca;margin-top:2px;}
.timeline-event .description{margin-top:6px;background:#f3f6ff;padding:8px;border-radius:6px;font-size:0.95rem;}

/* map */
.map-container{width:100%;height:320px;margin:16px 0;border-radius:6px;overflow:hidden;border:1px solid #ddd;position:relative;}
.map-overlay{position:absolute;top:8px;left:50%;transform:translateX(-50%);background:rgba(255,255,255,0.9);padding:6px 10px;border-radius:6px;font-weight:bold;z-index:10;}

/* delivery wall */
.delivery-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px;margin-top:12px;}
.delivery-item img, .delivery-item video{width:100%;border-radius:8px;display:block;}
.delivery-desc{margin-top:8px;font-size:0.95rem;color:#333;line-height:1.5;background:#fff;padding:10px;border-radius:6px;border:1px solid #eee;min-height:120px;}

/* reviews */
#reviewsBoard{margin-top:10px;padding:12px;border:1px solid var(--brand);border-radius:6px;background:#fff;min-height:56px;position:relative;overflow:hidden;}
.review{opacity:0;position:absolute;transition:opacity 1s;width:100%;text-align:center;font-size:1rem;padding:6px}
.review.show{opacity:1;position:relative}

/* newsletter & support */
.newsletter{display:flex;gap:10px;margin-top:10px;}
.newsletter input{flex:1;padding:8px;border-radius:4px;border:1px solid #ddd;}
.newsletter button{padding:8px 12px;border-radius:4px;border:none;background:var(--brand);color:#fff;cursor:pointer}
#supportPopup{display:none;position:fixed;bottom:18px;right:18px;background:#fff;padding:12px;border-radius:8px;box-shadow:0 8px 20px rgba(0,0,0,0.12);z-index:10000;width:280px}

/* footer */
footer{background:#f8f8f8;padding:18px;text-align:center;color:var(--brand);border-top:1px solid #ddd;margin-top:18px;border-radius:0 0 6px 6px;}
.print-btn{margin-top:10px;padding:8px 12px;background:var(--brand);color:#fff;border:none;border-radius:6px;cursor:pointer}

/* blinking open hours */
.business-hours .open-hours{color:#00c853;animation:blink 1s infinite;font-weight:bold}
@keyframes blink{0%,50%,100%{opacity:1}25%,75%{opacity:0}}

@media (max-width:560px){ .tracking{flex-direction:column} .tracking button{width:100%} }
</style>
</head>
<body>

<!-- Navbar -->
<div class="navbar">
  <div class="logo" style="font-weight:bold;">Express Delivery</div>
  <div class="nav-links" id="navLinks">
    <a href="#home">Home</a>
    <a href="#track">Track Packages</a>
    <a href="#contact">Contact</a>
    <a href="admin.html">Admin</a>
  </div>
  <div class="hamburger" onclick="document.getElementById('navLinks').classList.toggle('active')">
    <div></div><div></div><div></div>
  </div>
</div>

<!-- Header -->
<header>
  <video autoplay loop muted playsinline>
    <source src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/From%20KlickPin%20CF%20Pin%20van%20Nayara%20Duartt%20op%20Slow%20in%202025.mov" type="video/mp4">
  </video>
  <div class="header-overlay">
    <h1>EXPRESS DELIVERY SERVICES LOGISTIC FIRM</h1>
    <p style="max-width:850px;margin:10px auto;">We provide reliable shipping and tracking. Enter your tracking code below to view the package timeline, sender & receiver details, and download the invoice PDF.</p>
  </div>
</header>

<!-- Home / delivery wall / reviews / newsletter -->
<section id="home" class="section">
  <h2 class="section-title">Delivery Wall</h2>
  <div class="delivery-grid">
    <!-- Item 1 -->
    <div class="delivery-item">
      <img src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/IMG_1676.jpeg" alt="Delivery 1">
      <div class="delivery-desc">
        Our logistics team carefully prepares every package for transit, securing fragile items with proper cushioning and tamper-evident seals. GPS-tracked vehicles and experienced couriers ensure each parcel follows the optimal route for timely delivery. Customer notifications provide transparency at every stage, reducing uncertainty and delivering peace of mind with every shipment.
      </div>
    </div>

    <!-- Item 2 -->
    <div class="delivery-item">
      <img src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/IMG_1677.webp" alt="Delivery 2">
      <div class="delivery-desc">
        We prioritize speed and reliability by leveraging a wide network of carriers and strategically positioned hubs. Our technology coordinates real-time routing and capacity planning, reducing delays and optimizing transit time. Dedicated customer support handles exceptions quickly, ensuring packages are rerouted or held safely until successful delivery, every time.
      </div>
    </div>

    <!-- Item 3 -->
    <div class="delivery-item">
      <img src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/IMG_1678.jpeg" alt="Delivery 3">
      <div class="delivery-desc">
        Packages are scanned at multiple checkpoints so you always know where your shipment is. Each scan updates the timeline event, which is viewable within the tracking page. This continuous visibility helps customers plan ahead, confirming arrival windows and reducing missed deliveries for better overall satisfaction and convenience.
      </div>
    </div>

    <!-- Item 4 -->
    <div class="delivery-item">
      <img src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/IMG_1680.jpeg" alt="Delivery 4">
      <div class="delivery-desc">
        Our fleet operates with rigorous safety standards, including routine vehicle maintenance and driver training. Temperature-controlled options are available for sensitive goods, while specialized packaging solutions protect valuable items. We also provide shipment insurance options, so you can choose the coverage that best matches the value of your cargo.
      </div>
    </div>

    <!-- Item 5 -->
    <div class="delivery-item">
      <img src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/IMG_1681.jpeg" alt="Delivery 5">
      <div class="delivery-desc">
        International shipments navigate customs efficiently with our documentation support and experienced brokers. We prepare paperwork accurately to avoid clearance delays, and our partners across borders coordinate smoothly to hand over parcels at transit points. This reduces unexpected fees, speeds customs processing, and keeps your delivery on schedule.
      </div>
    </div>

    <!-- Item 6 -->
    <div class="delivery-item">
      <img src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/IMG_1682.jpeg" alt="Delivery 6">
      <div class="delivery-desc">
        E-commerce retailers rely on our scalable logistics for high-volume peaks and seasonal demand. Integration-ready APIs and clear tracking updates maintain a consistent customer experience. Retailers can automate label creation and returns management, streamlining operations and reducing manual handling costs while delivering accurate delivery ETAs to buyers.
      </div>
    </div>

    <!-- Item 7 -->
    <div class="delivery-item">
      <img src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/IMG_1683.jpeg" alt="Delivery 7">
      <div class="delivery-desc">
        When packages require special handling or scheduled delivery, our coordination team sets time windows and confirms recipient availability. Drivers use mobile apps to confirm identity and capture proof-of-delivery photos or signatures. These features reduce disputes and give recipients confidence that deliveries meet their expectations and timing requirements.
      </div>
    </div>

    <!-- Item 8 (video) -->
    <div class="delivery-item">
      <video autoplay loop muted playsinline>
        <source src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/From%20KlickPin%20CF%20White%20Truck%20Parked%20Next%20to%20Bridge.mov" type="video/mp4">
      </video>
      <div class="delivery-desc">
        Watch our operation in action: dispatch planning, loading procedures, and on-road monitoring combine to deliver reliability. The video illustrates efficient loading techniques and coordinated dispatch that maintain tight schedules. Real-time tracking and proactive customer communication complement these operations to keep customers informed throughout each shipment’s journey.
      </div>
    </div>
  </div>

  <h2 class="section-title" style="margin-top:22px">Customer Reviews</h2>
  <div id="reviewsBoard"></div>

  <h2 class="section-title" style="margin-top:18px">Subscribe</h2>
  <div class="newsletter">
    <input id="newsletterEmail" placeholder="Enter your email">
    <button onclick="subscribeNewsletter()">Subscribe</button>
  </div>
</section>

<!-- Track section -->
<section id="track" class="section">
  <h2 class="section-title">Track Your Package</h2>
  <div class="tracking">
    <input type="text" id="trackingNumber" placeholder="Enter Tracking ID (e.g. ZWB-208345675)">
    <button onclick="trackPackage()">Track Now</button>
  </div>

  <div id="shipmentTracking" class="shipment-tracking" style="display:none"></div>
  <div id="shipmentContent" class="shipment-content" style="display:none"></div>

  <div class="map-container">
    <div class="map-overlay">CURRENT LOCATION ON MAP</div>
    <div id="receiverMap" style="width:100%;height:100%"></div>
  </div>
</section>

<!-- Contact & Support -->
<section id="contact" class="section">
  <h2 class="section-title">Contact Us</h2>
  <p>Phone: +1 (941) 207-8626</p>
  <p>Email: <a href="mailto:Expressdeliveryservice0016@gmail.com">Expressdeliveryservice0016@gmail.com</a></p>
  <button onclick="openSupport()" class="print-btn">Support</button>

  <div style="margin-top:18px;">
    <div class="business-hours">
      <span>Friday: <span class="open-hours">Open 24 hours</span></span><br>
      <span>Saturday: <span class="open-hours">Open 24 hours</span></span><br>
      <span>Sunday: <span class="open-hours">Open 24 hours</span></span>
    </div>
  </div>
</section>

<!-- Support Popup -->
<div id="supportPopup">
  <h3>Welcome to Express Delivery Service!</h3>
  <form id="supportForm">
    <input type="text" id="supportName" placeholder="Your Name" required style="width:100%;margin-bottom:8px;padding:8px">
    <input type="email" id="supportEmail" placeholder="Your Email" required style="width:100%;margin-bottom:8px;padding:8px">
    <textarea id="supportMessage" placeholder="Your Message" required style="width:100%;margin-bottom:8px;padding:8px"></textarea>
    <button type="submit" style="background:var(--brand);color:#fff;padding:8px;border:none;border-radius:6px;cursor:pointer">Send</button>
  </form>
  <button onclick="closeSupport()" style="margin-top:8px;background:#eee;border:none;padding:6px;border-radius:6px;cursor:pointer">Close</button>
</div>

<footer>
  <div style="max-width:1100px;margin:0 auto;padding:14px;text-align:center;">
    <p>©2025 Express Delivery Service. All Rights Reserved.</p>
    <div><a href="#home">Home</a> | <a href="#track">Track Packages</a> | <a href="#contact">Contact</a> | <a href="admin.html">Admin</a></div>
  </div>
</footer>

<!-- Hidden template used for PDF generation -->
<div id="receiptTemplate" style="display:none;width:820px;padding:20px;font-family:Arial, sans-serif;background:#fff;border:1px solid #ddd;">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <div>
      <img src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/delivery-truck.png" style="height:44px" alt="logo">
      <img src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/airplane.png" style="height:44px;margin-left:8px" alt="logo2">
    </div>
    <div id="tmplCompanyName" style="font-weight:bold;font-size:22px"></div>
  </div>
  <hr>
  <div style="margin-top:10px;">
    <div><b>Tracking Number:</b> <span id="tmplTrackingNumber"></span></div>
    <div><b>Content:</b> <span id="tmplContent"></span></div>
    <div style="margin-top:8px"><b>Sender:</b> <span id="tmplSender"></span></div>
    <div><b>Receiver:</b> <span id="tmplReceiver"></span></div>
    <div style="margin-top:12px;font-weight:bold;font-size:16px">Amount: $<span id="tmplAmount"></span></div>
  </div>
</div>

<!-- libs for PDF creation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
/* ---------- Utilities ---------- */
function openSupport(){ document.getElementById('supportPopup').style.display='block'; }
function closeSupport(){ document.getElementById('supportPopup').style.display='none'; }
document.getElementById('supportForm').addEventListener('submit', function(e){
  e.preventDefault();
  // store support message locally for demo; replace with server-side endpoint in production
  const name = document.getElementById('supportName').value.trim();
  const email = document.getElementById('supportEmail').value.trim();
  const msg = document.getElementById('supportMessage').value.trim();
  const supports = JSON.parse(localStorage.getItem('supportMessages')||'[]');
  supports.push({name,email,msg,time:new Date().toISOString()});
  localStorage.setItem('supportMessages', JSON.stringify(supports));
  alert('Support message sent — we will contact you shortly.');
  closeSupport();
});

/* Newsletter */
function subscribeNewsletter(){
  const email = (document.getElementById('newsletterEmail').value || '').trim();
  if(!email) return alert('Enter email');
  let list = (localStorage.getItem('newsletterEmails')||'').split(',').filter(Boolean);
  if(list.includes(email)) return alert('This email is already subscribed.');
  list.push(email);
  localStorage.setItem('newsletterEmails', list.join(','));
  alert('Subscribed — thank you!');
}

/* Reviews rotation */
function loadReviews(){
  const reviewsBoard = document.getElementById('reviewsBoard');
  const reviews = (localStorage.getItem('customerReviews') || '⭐ Alice: Excellent service! Fast and reliable.|⭐⭐ Bob: Timely delivery, good support.|⭐⭐⭐ Carla: Great tracking updates.').split('|');
  reviewsBoard.innerHTML = '';
  reviews.forEach((r,i)=>{
    const div = document.createElement('div');
    div.className = 'review';
    div.id = 'rv'+i;
    div.innerText = r;
    reviewsBoard.appendChild(div);
  });
  let idx = 0;
  function rotate(){ document.querySelectorAll('.review').forEach(el=>el.classList.remove('show')); const e = document.getElementById('rv'+idx); if(e) e.classList.add('show'); idx = (idx+1) % reviews.length; }
  rotate(); setInterval(rotate,5000);
}

/* Map fallback */
function initMapsDefault(){
  document.getElementById('receiverMap').innerHTML = `<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2482.614141570908!2d30.4252616!3d60.0348099!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1" width="100%" height="100%" style="border:0;" loading="lazy"></iframe>`;
}

/* ---------- Tracking logic ---------- */
function trackPackage(){
  const number = (document.getElementById('trackingNumber').value || '').trim();
  const trackingDiv = document.getElementById('shipmentTracking');
  const contentDiv = document.getElementById('shipmentContent');

  trackingDiv.style.display = 'block';
  trackingDiv.innerHTML = '<div style="font-weight:bold">Searching...</div>';
  contentDiv.style.display = 'none';

  setTimeout(()=>{
    let shipments = [];
    try { shipments = JSON.parse(localStorage.getItem('shipments')||'[]'); } catch(e){ shipments = []; }
    const s = shipments.find(x => x.trackingNumber === number);
    if(!s){ trackingDiv.innerHTML = '<div style="font-weight:bold;color:#d00">Tracking number not found.</div>'; initMapsDefault(); return; }

    // timeline
    trackingDiv.innerHTML = `<div style="font-weight:bold">Tracking Shipment: ${s.trackingNumber}</div>
      <div class="timeline">${(s.timeline||[]).map(ev => `
         <div class="timeline-event ${(ev.completed? 'completed':'')}">
           <div class="tick"></div>
           <div class="time">${ev.time}</div>
           <div class="description">${ev.description} <div style="margin-top:8px;display:inline-block;background:#eee;padding:4px;border-radius:4px">${ev.status||''}</div></div>
         </div>`).join('')}</div>`;

    // content + details (read-only)
    contentDiv.style.display = 'block';
    contentDiv.innerHTML = `<div style="font-weight:bold;margin-bottom:8px">Content of Shipment: ${s.content || 'Unknown'}</div>
      <div><b>Origin Area:</b> ${s.origin||'N/A'} &nbsp; <b>Destination Area:</b> ${s.destination||'N/A'}</div>
      <div style="margin-top:10px"><b>Sender:</b><br>${s.sender?.name || ''}<br>${s.sender?.address || ''}</div>
      <div style="margin-top:10px"><b>Receiver:</b><br>${s.receiver?.name || ''}<br>${s.receiver?.address || ''}<br>${s.receiver?.mobile || ''}</div>
      <button class="print-btn" onclick="downloadInvoicePDF('${s.trackingNumber}')">Download Receipt (PDF)</button>`;

    // map
    if(s.receiver && s.receiver.lat && s.receiver.lng){
      const lat = s.receiver.lat, lng = s.receiver.lng;
      // Google embed using coordinates
      const mapUrl = `https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d0!2d${lng}!3d${lat}!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1`;
      document.getElementById('receiverMap').innerHTML = `<a href="https://www.google.com/maps?q=${lat},${lng}" target="_blank" style="display:block;"><iframe src="${mapUrl}" width="100%" height="100%" style="border:0;" loading="lazy"></iframe></a>`;
    } else {
      initMapsDefault();
    }
  },450);
}

/* ---------- PDF generation (read-only on public) ---------- */
async function fillReceiptTemplate(shipment){
  document.getElementById('tmplCompanyName').innerText = shipment.receipt?.companyName || 'Express Delivery Service';
  document.getElementById('tmplTrackingNumber').innerText = shipment.trackingNumber;
  document.getElementById('tmplContent').innerText = shipment.content || '';
  document.getElementById('tmplSender').innerText = (shipment.sender?.name||'') + (shipment.sender?.address? ' — ' + shipment.sender.address:'');
  document.getElementById('tmplReceiver').innerText = (shipment.receiver?.name||'') + (shipment.receiver?.address? ' — ' + shipment.receiver.address:'');
  document.getElementById('tmplAmount').innerText = shipment.receipt?.amount || '0.00';
  return document.getElementById('receiptTemplate');
}

async function downloadInvoicePDF(trackingNumber){
  const { jsPDF } = window.jspdf;
  let shipments = [];
  try { shipments = JSON.parse(localStorage.getItem('shipments')||'[]'); } catch(e){ shipments = []; }
  const s = shipments.find(x=>x.trackingNumber === trackingNumber);
  if(!s) return alert('Shipment not found');

  const tpl = await fillReceiptTemplate(s);
  tpl.style.display = 'block'; tpl.style.background = '#fff';

  try {
    const canvas = await html2canvas(tpl, { scale:2 });
    const img = canvas.toDataURL('image/png');
    // page width & height in px
    const pdf = new jsPDF({ unit:'px', format:[canvas.height, canvas.width] });
    pdf.addImage(img, 'PNG', 0, 0, canvas.width, canvas.height);
    pdf.save(`Receipt-${s.trackingNumber}.pdf`);
  } catch(err){
    console.error(err);
    alert('PDF generation failed. You can print from browser instead.');
  } finally {
    tpl.style.display = 'none';
  }
}

/* ---------- Initialization & sample data ---------- */
document.addEventListener('DOMContentLoaded', () => {
  loadReviews();
  initMapsDefault();

  // create demo shipment if none
  try {
    let shipments = JSON.parse(localStorage.getItem('shipments') || '[]');
    if(!shipments.length){
      shipments.push({
        trackingNumber: 'ZWB-208345675',
        content: 'Package',
        origin: 'London UK',
        destination: 'St. Petersburg, Russia',
        sender: { name: 'James', address: 'London UK' },
        receiver: { name: 'Podvezennaya Elena Ivanovna', address: '195299 St. Petersburg, Prosveshcheniya Avenue 104, Apt. 281', mobile:'+79932195775', lat:59.9741, lng:30.3232 },
        timeline: [
          { time:'23 Sep 2025 07:30', description:'✅ Item has arrived at Vnukovo International Airport, Russia', status:'ON HOLD', completed:true },
          { time:'22 Sep 2025 14:00', description:'☑️ Your item is on its way from London, UK', status:'IN TRANSIT', completed:true }
        ],
        receipt: { companyName: 'Express Delivery Service', amount: '49.99' }
      });
      localStorage.setItem('shipments', JSON.stringify(shipments));
    }
  } catch(e){ console.error(e); }
});
</script>
</body>
</html>
