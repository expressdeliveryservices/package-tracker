<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard - Express Delivery</title>
<style>
body { font-family: Arial, sans-serif; background: #f0f2f5; margin: 0; padding: 0; }
header { background: #1e90ff; color: white; padding: 15px; text-align: center; }
.container { max-width: 1000px; margin: 20px auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
input, textarea, select, button { margin: 5px 0; padding: 8px; width: 100%; border-radius: 3px; border: 1px solid #ccc; font-size: 14px; }
button { background: #1e90ff; color: white; border: none; cursor: pointer; }
button:hover { background: #1565c0; }
h2, h3 { color: #1e90ff; margin-top: 0; }
.section { margin-bottom: 30px; }
label { font-weight: bold; }
</style>
</head>
<body>

<header>
  <h1>Admin Dashboard</h1>
</header>

<div class="container">

  <!-- Login Section -->
  <div class="section" id="loginSection">
    <h2>Login</h2>
    <label>Email:</label>
    <input type="email" id="adminEmail" placeholder="Enter admin email">
    <label>Password:</label>
    <input type="password" id="adminPassword" placeholder="Enter password">
    <button id="loginBtn">Login</button>
    <p id="loginMessage" style="color:red;"></p>
  </div>

  <!-- Dashboard Section -->
  <div class="section" id="dashboardSection" style="display:none;">
    <h2>Upload Signature Stamp</h2>
    <input type="file" id="signatureStamp" accept="image/*">
    <div id="signaturePreview"></div>
    <button onclick="saveSignatureStamp()">Save Signature Stamp</button>

    <h2>Generate New Tracking Code</h2>
    <input type="text" id="newTrackingNumber" placeholder="New Tracking Code will be generated" readonly>
    <input type="text" id="newShipmentContent" placeholder="Shipment Content" required>
    <input type="text" id="newShipmentOrigin" placeholder="Origin Area" required>
    <input type="text" id="newShipmentDestination" placeholder="Destination Area" required>
    <input type="text" id="newOrderId" placeholder="Order ID" required>
    <input type="date" id="newEstDeliveryDate" placeholder="Estimated Delivery Date" required>
    <input type="text" id="newModeOfTransport" placeholder="Mode of Transport (e.g., Air, Sea)" required>
    <input type="text" id="newTypeOfShipment" placeholder="Type of Shipment (e.g., Express, Standard)" required>
    <input type="text" id="newQuantity" placeholder="Quantity (e.g., 2 boxes)" required>
    <input type="date" id="newOfficialStampDate" placeholder="Official Stamp Date" required>

    <h3>Sender Details</h3>
    <input type="text" id="newSenderName" placeholder="Sender Name" required>
    <input type="text" id="newSenderAddress" placeholder="Sender Address" required>

    <h3>Receiver Details</h3>
    <input type="text" id="newReceiverName" placeholder="Receiver Name" required>
    <input type="text" id="newReceiverAddress" placeholder="Receiver Address" required>
    <input type="text" id="newReceiverMobile" placeholder="Receiver Mobile" required>
    <input type="number" id="newReceiverLat" step="0.0001" placeholder="Receiver Latitude" required>
    <input type="number" id="newReceiverLng" step="0.0001" placeholder="Receiver Longitude" required>

    <h3>Timeline</h3>
    <textarea id="newTimeline" rows="4" placeholder='Enter timeline events as JSON array (e.g., [{"time":"22 Sep 2025 12:33","description":"âœ… Item shipped","status":"IN TRANSIT","completed":true}])' required></textarea>

    <button onclick="generateTrackingCode()">Generate Tracking Code</button>

    <h2>Edit Shipments</h2>
    <select id="shipmentSelect" onchange="loadShipment()">
      <option value="">Select a shipment</option>
    </select>
    <input type="text" id="trackingNumber" placeholder="Tracking Number" readonly>
    <input type="text" id="shipmentContent" placeholder="Shipment Content">
    <input type="text" id="shipmentOrigin" placeholder="Origin Area">
    <input type="text" id="shipmentDestination" placeholder="Destination Area">
    <input type="text" id="orderId" placeholder="Order ID">
    <input type="date" id="estDeliveryDate" placeholder="Estimated Delivery Date">
    <input type="text" id="modeOfTransport" placeholder="Mode of Transport">
    <input type="text" id="typeOfShipment" placeholder="Type of Shipment">
    <input type="text" id="quantity" placeholder="Quantity">
    <input type="date" id="officialStampDate" placeholder="Official Stamp Date">

    <h3>Sender Details</h3>
    <input type="text" id="senderName" placeholder="Sender Name">
    <input type="text" id="senderAddress" placeholder="Sender Address">

    <h3>Receiver Details</h3>
    <input type="text" id="receiverName" placeholder="Receiver Name">
    <input type="text" id="receiverAddress" placeholder="Receiver Address">
    <input type="text" id="receiverMobile" placeholder="Receiver Mobile">
    <input type="number" id="receiverLat" step="0.0001" placeholder="Receiver Latitude">
    <input type="number" id="receiverLng" step="0.0001" placeholder="Receiver Longitude">

    <h3>Timeline</h3>
    <textarea id="timeline" rows="4" placeholder='Enter timeline events as JSON array'></textarea>

    <button onclick="saveShipment()">Save Shipment</button>

    <button style="background:red;margin-top:15px;" onclick="logout()">Logout</button>
  </div>

</div>

<script>
const COMPANY_NAME = "Express Delivery Service";
const ADMIN_EMAIL = "Expressdeliveryservice0016@gmail.com";
const ADMIN_PASSWORD = "Umuojima";

// Login/Logout
function login() {
  const email = document.getElementById('adminEmail').value.trim();
  const pass = document.getElementById('adminPassword').value.trim();
  if(email === ADMIN_EMAIL && pass === ADMIN_PASSWORD){
    document.getElementById('loginSection').style.display = 'none';
    document.getElementById('dashboardSection').style.display = 'block';
    loadData();
  } else {
    document.getElementById('loginMessage').innerText = "Invalid email or password!";
  }
}

function logout() {
  document.getElementById('loginSection').style.display = 'block';
  document.getElementById('dashboardSection').style.display = 'none';
  document.getElementById('adminEmail').value = '';
  document.getElementById('adminPassword').value = '';
  document.getElementById('loginMessage').innerText = '';
}

// Signature Stamp
function saveSignatureStamp() {
  const fileInput = document.getElementById('signatureStamp');
  const preview = document.getElementById('signaturePreview');
  if(fileInput.files.length > 0){
    const file = fileInput.files[0];
    if(file.type.startsWith('image/') && file.size <= 2*1024*1024){
      const reader = new FileReader();
      reader.onload = e => {
        const base64Image = e.target.result;
        localStorage.setItem('signatureStamp', base64Image);
        preview.innerHTML = `<img src="${base64Image}" alt="Signature Stamp" style="max-width:100px;"><p>Current signature stamp</p>`;
        alert("Signature stamp saved successfully!");
      }
      reader.readAsDataURL(file);
    } else alert("Please upload a valid image (max 2MB).");
  } else alert("Select an image to upload.");
}

// Load/Save Shipments
function loadData() {
  const shipments = JSON.parse(localStorage.getItem('shipments')||'[]');
  const shipmentSelect = document.getElementById('shipmentSelect');
  shipmentSelect.innerHTML = '<option value="">Select a shipment</option>';
  shipments.forEach(s => {
    const option = document.createElement('option');
    option.value = s.trackingNumber;
    option.text = `${s.trackingNumber} - ${s.content || 'Unknown'}`;
    shipmentSelect.appendChild(option);
  });

  const signatureStamp = localStorage.getItem('signatureStamp');
  const preview = document.getElementById('signaturePreview');
  preview.innerHTML = signatureStamp ? `<img src="${signatureStamp}" alt="Signature Stamp" style="max-width:100px;"><p>Current signature stamp</p>` : `<p>No signature stamp uploaded</p>`;
}

function loadShipment(){
  const trackingNumber = document.getElementById('shipmentSelect').value;
  if(!trackingNumber) return;
  const shipments = JSON.parse(localStorage.getItem('shipments')||'[]');
  const s = shipments.find(sh => sh.trackingNumber===trackingNumber);
  if(!s) return;
  document.getElementById('trackingNumber').value = s.trackingNumber || '';
  document.getElementById('shipmentContent').value = s.content || '';
  document.getElementById('shipmentOrigin').value = s.origin || '';
  document.getElementById('shipmentDestination').value = s.destination || '';
  document.getElementById('orderId').value = s.orderId || '';
  document.getElementById('estDeliveryDate').value = s.estDeliveryDate || '';
  document.getElementById('modeOfTransport').value = s.modeOfTransport || '';
  document.getElementById('typeOfShipment').value = s.typeOfShipment || '';
  document.getElementById('quantity').value = s.quantity || '';
  document.getElementById('officialStampDate').value = s.officialStampDate || '';
  document.getElementById('senderName').value = s.sender.name || '';
  document.getElementById('senderAddress').value = s.sender.address || '';
  document.getElementById('receiverName').value = s.receiver.name || '';
  document.getElementById('receiverAddress').value = s.receiver.address || '';
  document.getElementById('receiverMobile').value = s.receiver.mobile || '';
  document.getElementById('receiverLat').value = s.receiver.lat || '';
  document.getElementById('receiverLng').value = s.receiver.lng || '';
  document.getElementById('timeline').value = JSON.stringify(s.timeline||[],null,2);
}

function saveShipment(){
  try {
    const trackingNumber = document.getElementById('trackingNumber').value.trim();
    if(!trackingNumber) throw new Error("Select a shipment to edit.");
    const shipment = {
      trackingNumber,
      content: document.getElementById('shipmentContent').value.trim(),
      origin: document.getElementById('shipmentOrigin').value.trim(),
      destination: document.getElementById('shipmentDestination').value.trim(),
      orderId: document.getElementById('orderId').value.trim(),
      estDeliveryDate: document.getElementById('estDeliveryDate').value.trim(),
      modeOfTransport: document.getElementById('modeOfTransport').value.trim(),
      typeOfShipment: document.getElementById('typeOfShipment').value.trim(),
      quantity: document.getElementById('quantity').value.trim(),
      officialStampDate: document.getElementById('officialStampDate').value.trim(),
      officialStamp: localStorage.getItem('signatureStamp')||'',
      sender:{
        name: document.getElementById('senderName').value.trim(),
        address: document.getElementById('senderAddress').value.trim()
      },
      receiver:{
        name: document.getElementById('receiverName').value.trim(),
        address: document.getElementById('receiverAddress').value.trim(),
        mobile: document.getElementById('receiverMobile').value.trim(),
        lat: parseFloat(document.getElementById('receiverLat').value)||0,
        lng: parseFloat(document.getElementById('receiverLng').value)||0
      },
      timeline: JSON.parse(document.getElementById('timeline').value.trim()||'[]')
    };
    let shipments = JSON.parse(localStorage.getItem('shipments')||'[]');
    const index = shipments.findIndex(s=>s.trackingNumber===trackingNumber);
    if(index!==-1) shipments[index]=shipment;
    else shipments.push(shipment);
    localStorage.setItem('shipments',JSON.stringify(shipments));
    alert("Shipment saved!");
    loadData();
  } catch(e){ alert(`Error: ${e.message}`); }
}

function generateTrackingCode(){
  try{
    const letters = String.fromCharCode(...Array(3).fill().map(()=>65+Math.floor(Math.random()*26)));
    const numbers = Math.floor(100000000+Math.random()*900000000).toString();
    const newTracking = `${letters}-${numbers}`;

    const shipment = {
      trackingNumber: newTracking,
      content: document.getElementById('newShipmentContent').value.trim(),
      origin: document.getElementById('newShipmentOrigin').value.trim(),
      destination: document.getElementById('newShipmentDestination').value.trim(),
      orderId: document.getElementById('newOrderId').value.trim(),
      estDeliveryDate: document.getElementById('newEstDeliveryDate').value.trim(),
      modeOfTransport: document.getElementById('newModeOfTransport').value.trim(),
      typeOfShipment: document.getElementById('newTypeOfShipment').value.trim(),
      quantity: document.getElementById('newQuantity').value.trim(),
      officialStampDate: document.getElementById('newOfficialStampDate').value.trim(),
      officialStamp: localStorage.getItem('signatureStamp')||'',
      sender:{
        name: document.getElementById('newSenderName').value.trim(),
        address: document.getElementById('newSenderAddress').value.trim()
      },
      receiver:{
        name: document.getElementById('newReceiverName').value.trim(),
        address: document.getElementById('newReceiverAddress').value.trim(),
        mobile: document.getElementById('newReceiverMobile').value.trim(),
        lat: parseFloat(document.getElementById('newReceiverLat').value)||0,
        lng: parseFloat(document.getElementById('newReceiverLng').value)||0
      },
      timeline: JSON.parse(document.getElementById('newTimeline').value.trim()||'[]')
    };

    let shipments = JSON.parse(localStorage.getItem('shipments')||'[]');
    shipments.push(shipment);
    localStorage.setItem('shipments',JSON.stringify(shipments));

    document.getElementById('newTrackingNumber').value = newTracking;
    alert(`Tracking code generated: ${newTracking}`);
    loadData();
  } catch(e){ alert(`Error: ${e.message}`);}
}

document.addEventListener('DOMContentLoaded',function(){
  document.getElementById('loginBtn').addEventListener('click',login);
  document.getElementById('logoutBtn').addEventListener('click',logout);
});
</script>

</body>
</html>
