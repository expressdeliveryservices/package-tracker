<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Express Delivery Service</title>
<style>
body{font-family:Arial,sans-serif;background:#f0f2f5;margin:0;padding:0;}
header{background:#1e90ff;color:white;padding:15px;text-align:center;}
.container{max-width:1000px;margin:20px auto;padding:20px;background:white;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.1);}
input,textarea,select,button{margin:5px 0;padding:8px;width:100%;border-radius:3px;border:1px solid #ccc;font-size:14px;}
button{background:#1e90ff;color:white;border:none;cursor:pointer;}
button:hover{background:#1565c0;}
h2{color:#1e90ff;margin-top:0;}
.section{margin-bottom:30px;}
label{font-weight:bold;}
.shipment-form div{margin-bottom:10px;}
#generateTrackingCode{background:#4CAF50;color:white;}
#receiptModal,#signatureModal,#publicReceiptModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;z-index:999;}
#receiptContent,#signatureContent,#publicReceiptContent{background:#fff;padding:20px;max-width:600px;width:90%;position:relative;box-shadow:0 0 10px rgba(0,0,0,0.3);}
#receiptContent img,#signatureContent img,#publicReceiptContent img{max-width:120px;display:block;margin:10px auto;}
.closeReceipt,.closeSignature,.closePublicReceipt{position:absolute;top:10px;right:15px;font-size:24px;cursor:pointer;color:#333;}
.watermark{position:absolute;top:40%;left:10%;font-size:50px;color:rgba(0,0,0,0.1);transform:rotate(-30deg);z-index:0;}
</style>
</head>
<body>

<header>
  <h1>Express Delivery Service</h1>
</header>

<div class="container">

  <!-- Admin Login -->
  <div class="section" id="loginSection">
    <h2>Admin Login</h2>
    <label>Email:</label>
    <input type="email" id="adminEmail" placeholder="Enter admin email">
    <label>Password:</label>
    <input type="password" id="adminPassword" placeholder="Enter password">
    <button onclick="login()">Login</button>
    <p id="loginMessage" style="color:red;"></p>
  </div>

  <!-- Admin Dashboard -->
  <div class="section" id="dashboardSection" style="display:none;">
    <h2>Manage Shipments</h2>
    <div class="shipment-form">
      <input type="text" id="trackingNumber" placeholder="Tracking Number" readonly>
      <div><label>Content:</label><input type="text" id="shipmentContent" placeholder="Shipment Content"></div>
      <div><label>Origin:</label><input type="text" id="shipmentOrigin" placeholder="Origin"></div>
      <div><label>Destination:</label><input type="text" id="shipmentDestination" placeholder="Destination"></div>
      <h3>Sender</h3>
      <div><label>Name:</label><input type="text" id="senderName" placeholder="Sender Name"></div>
      <div><label>Address:</label><input type="text" id="senderAddress" placeholder="Sender Address"></div>
      <h3>Receiver</h3>
      <div><label>Name:</label><input type="text" id="receiverName" placeholder="Receiver Name"></div>
      <div><label>Address:</label><input type="text" id="receiverAddress" placeholder="Receiver Address"></div>
      <div><label>Mobile:</label><input type="text" id="receiverMobile" placeholder="Receiver Mobile"></div>
      <div><label>Latitude:</label><input type="number" id="receiverLat" step="0.0001"></div>
      <div><label>Longitude:</label><input type="number" id="receiverLng" step="0.0001"></div>
      <div><label>Payment Method:</label><input type="text" id="paymentMethod"></div>
      <div><label>Amount:</label><input type="number" id="amount"></div>
      <h3>Timeline</h3>
      <textarea id="timeline" rows="4" placeholder="JSON timeline"></textarea>
      <button onclick="saveShipment()">Save Shipment</button>
      <button onclick="openReceipt()">View Receipt</button>
      <button onclick="openSignature()">Edit Signature</button>
    </div>
    <button style="background:red;margin-top:15px;" onclick="logout()">Logout</button>
  </div>

  <!-- Public Tracking -->
  <div class="section" id="publicSection">
    <h2>Track Your Shipment</h2>
    <label>Enter Tracking Code:</label>
    <input type="text" id="publicTrackingInput" placeholder="e.g. ZWB-208345675">
    <button onclick="publicTrack()">Track</button>
  </div>

</div>

<!-- Admin Receipt Modal -->
<div id="receiptModal">
  <div id="receiptContent">
    <span class="closeReceipt" onclick="closeReceipt()">×</span>
    <div class="watermark">CERTIFIED TRUE COPY</div>
    <img id="companyLogo" src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/IMG_1679.png" alt="Company Logo">
    <h2>Express Delivery Service</h2>
    <p>Email: Expressdeliveryservice0016@gmail.com</p>
    <p>Locations: China | London | USA</p>
    <p><strong>Tracking Code:</strong> <span id="receiptTracking"></span></p>
    <p><strong>Content:</strong> <span id="receiptContentText"></span></p>
    <p><strong>Origin:</strong> <span id="receiptOrigin"></span> | <strong>Destination:</strong> <span id="receiptDestination"></span></p>
    <p><strong>Sender:</strong> <span id="receiptSender"></span></p>
    <p><strong>Receiver:</strong> <span id="receiptReceiver"></span> | <strong>Mobile:</strong> <span id="receiptMobile"></span></p>
    <p><strong>Payment Method:</strong> <span id="receiptPayment"></span></p>
    <p><strong>Amount:</strong> $<span id="receiptAmount"></span></p>
  </div>
</div>

<!-- Signature Modal -->
<div id="signatureModal">
  <div id="signatureContent">
    <span class="closeSignature" onclick="closeSignature()">×</span>
    <h2>Edit Signature</h2>
    <input type="text" id="signatureInput" placeholder="Enter image URL for signature">
    <button onclick="saveSignature()">Save Signature</button>
  </div>
</div>

<!-- Public Receipt Modal -->
<div id="publicReceiptModal">
  <div id="publicReceiptContent">
    <span class="closePublicReceipt" onclick="closePublicReceipt()">×</span>
    <div class="watermark">CERTIFIED TRUE COPY</div>
    <img id="publicCompanyLogo" src="https://raw.githubusercontent.com/expressdeliveryservices/package-tracker/refs/heads/main/IMG_1679.png" alt="Company Logo">
    <h2>Express Delivery Service</h2>
    <p>Email: Expressdeliveryservice0016@gmail.com</p>
    <p>Locations: China | London | USA</p>
    <p><strong>Tracking Code:</strong> <span id="publicTracking"></span></p>
    <p><strong>Content:</strong> <span id="publicContent"></span></p>
    <p><strong>Origin:</strong> <span id="publicOrigin"></span> | <strong>Destination:</strong> <span id="publicDestination"></span></p>
    <p><strong>Sender:</strong> <span id="publicSender"></span></p>
    <p><strong>Receiver:</strong> <span id="publicReceiver"></span> | <strong>Mobile:</strong> <span id="publicMobile"></span></p>
    <p><strong>Payment Method:</strong> <span id="publicPayment"></span></p>
    <p><strong>Amount:</strong> $<span id="publicAmount"></span></p>
    <button onclick="downloadInvoice()">Download Invoice</button>
  </div>
</div>

<script>
// Admin Credentials
const ADMIN_EMAIL = "Expressdeliveryservice0016@gmail.com";
const ADMIN_PASSWORD = "Umuojima";
let SIGNATURE_URL = "https://via.placeholder.com/150?text=Signature";

// Login
function login(){
  const email = document.getElementById('adminEmail').value.trim();
  const pass = document.getElementById('adminPassword').value.trim();
  if(email === ADMIN_EMAIL && pass === ADMIN_PASSWORD){
    document.getElementById('loginSection').style.display='none';
    document.getElementById('dashboardSection').style.display='block';
    loadData();
  } else { document.getElementById('loginMessage').innerText="Invalid email or password!";}
}

// Logout
function logout(){
  document.getElementById('loginSection').style.display='block';
  document.getElementById('dashboardSection').style.display='none';
  document.getElementById('adminEmail').value='';
  document.getElementById('adminPassword').value='';
  document.getElementById('loginMessage').innerText='';
}

// Load data
function loadData(){
  const shipments = JSON.parse(localStorage.getItem('shipments') || '[]');
  if(shipments.length>0){
    const s=shipments[0];
    document.getElementById('trackingNumber').value=s.trackingNumber;
    document.getElementById('shipmentContent').value=s.content;
    document.getElementById('shipmentOrigin').value=s.origin;
    document.getElementById('shipmentDestination').value=s.destination;
    document.getElementById('senderName').value=s.sender.name;
    document.getElementById('senderAddress').value=s.sender.address;
    document.getElementById('receiverName').value=s.receiver.name;
    document.getElementById('receiverAddress').value=s.receiver.address;
    document.getElementById('receiverMobile').value=s.receiver.mobile;
    document.getElementById('receiverLat').value=s.receiver.lat;
    document.getElementById('receiverLng').value=s.receiver.lng;
    document.getElementById('paymentMethod').value=s.receipt.paymentMethod;
    document.getElementById('amount').value=s.receipt.amount;
    document.getElementById('timeline').value=JSON.stringify(s.timeline,null,2);
  }
}

// Save shipment
function saveShipment(){
  try{
    const shipment={
      trackingNumber: document.getElementById('trackingNumber').value.trim(),
      content: document.getElementById('shipmentContent').value.trim(),
      origin: document.getElementById('shipmentOrigin').value.trim(),
      destination: document.getElementById('shipmentDestination').value.trim(),
      sender:{name:document.getElementById('senderName').value,address:document.getElementById('senderAddress').value},
      receiver:{name:document.getElementById('receiverName').value,address:document.getElementById('receiverAddress').value,mobile:document.getElementById('receiverMobile').value,lat:parseFloat(document.getElementById('receiverLat').value),lng:parseFloat(document.getElementById('receiverLng').value)},
      timeline:JSON.parse(document.getElementById('timeline').value),
      receipt:{companyName:"Express Delivery Service",paymentMethod:document.getElementById('paymentMethod').value,amount:document.getElementById('amount').value,signature:SIGNATURE_URL}
    };
    let shipments=JSON.parse(localStorage.getItem('shipments')||'[]');
    const index=shipments.findIndex(s=>s.trackingNumber===shipment.trackingNumber);
    if(index!==-1) shipments[index]=shipment; else shipments.push(shipment);
    localStorage.setItem('shipments',JSON.stringify(shipments));
    alert("Shipment saved!");
  } catch(e){alert("Invalid data! Check timeline JSON.");}
}

// Open receipt (admin view)
function openReceipt(){
  const tracking=document.getElementById('trackingNumber').value;
  const shipments=JSON.parse(localStorage.getItem('shipments')||'[]');
  const s=shipments.find(x=>x.trackingNumber===tracking);
  if(!s){alert("Shipment not found!");return;}
  document.getElementById('receiptTracking').innerText=s.trackingNumber;
  document.getElementById('receiptContentText').innerText=s.content;
  document.getElementById('receiptOrigin').innerText=s.origin;
  document.getElementById('receiptDestination').innerText=s.destination;
  document.getElementById('receiptSender').innerText=s.sender.name+", "+s.sender.address;
  document.getElementById('receiptReceiver').innerText=s.receiver.name+", "+s.receiver.address;
  document.getElementById('receiptMobile').innerText=s.receiver.mobile;
  document.getElementById('receiptPayment').innerText=s.receipt.paymentMethod;
  document.getElementById('receiptAmount').innerText=s.receipt.amount;
  document.getElementById('receiptModal').style.display='flex';
}
function closeReceipt(){document.getElementById('receiptModal').style.display='none';}

// Edit Signature
function openSignature(){document.getElementById('signatureModal').style.display='flex';}
function closeSignature(){document.getElementById('signatureModal').style.display='none';}
function saveSignature(){
  const url=document.getElementById('signatureInput').value.trim();
  if(url){SIGNATURE_URL=url;alert("Signature updated!");closeSignature();}
  else alert("Enter a valid image URL.");
}

// Public tracking
function publicTrack(){
  const code=document.getElementById('publicTrackingInput').value.trim();
  const shipments=JSON.parse(localStorage.getItem('shipments')||'[]');
  const s=shipments.find(x=>x.trackingNumber===code);
  if(!s){alert("Tracking code not found!");return;}
  document.getElementById('publicTracking').innerText=s.trackingNumber;
  document.getElementById('publicContent').innerText=s.content;
  document.getElementById('publicOrigin').innerText=s.origin;
  document.getElementById('publicDestination').innerText=s.destination;
  document.getElementById('publicSender').innerText=s.sender.name+", "+s.sender.address;
  document.getElementById('publicReceiver').innerText=s.receiver.name+", "+s.receiver.address;
  document.getElementById('publicMobile').innerText=s.receiver.mobile;
  document.getElementById('publicPayment').innerText=s.receipt.paymentMethod;
  document.getElementById('publicAmount').innerText=s.receipt.amount;
  document.getElementById('publicReceiptModal').style.display='flex';
}
function closePublicReceipt(){document.getElementById('publicReceiptModal').style.display='none';}

// Download invoice (public)
function downloadInvoice(){
  const content=document.getElementById('publicReceiptContent').innerHTML;
  const blob=new Blob([content],{type:"application/pdf"});
  const link=document.createElement('a');
  link.href=URL.createObjectURL(blob);
  link.download="Invoice.pdf";
  link.click();
}

</script>

</body>
</html>
