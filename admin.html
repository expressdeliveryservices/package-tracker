<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>
<style>
body { font-family: Arial, sans-serif; padding: 20px; background:#f0f2f5; }
input, textarea, select, button { margin:5px 0; padding:8px; width:100%; }
button { cursor:pointer; background:#1e90ff; color:white; border:none; }
button:hover { background:#1565c0; }
</style>
</head>
<body>

<h2>Admin Dashboard - Express Delivery</h2>

<h3>Generate Shipment</h3>
<div>
  <input type="text" id="newTrackingNumber" placeholder="Tracking Code" readonly>
  <input type="text" id="newSender" placeholder="Sender Name" required>
  <input type="text" id="newReceiver" placeholder="Receiver Name" required>
  <input type="text" id="newOrigin" placeholder="Origin" required>
  <input type="text" id="newDestination" placeholder="Destination" required>
  <input type="text" id="newStatus" placeholder="Status (In Transit, Delivered)" required>
  <input type="date" id="newExpectedDelivery" placeholder="Expected Delivery" required>
  <textarea id="newExtendedDescription" placeholder="Notes / Description"></textarea>
  <button onclick="generateShipment()">Generate Shipment</button>
  <button onclick="downloadShipments()">Download shipments.json</button>
</div>

<script>
// Generate a new tracking code
function generateTrackingCode() {
  const letters = String.fromCharCode(...Array(3).fill().map(() => 65 + Math.floor(Math.random()*26)));
  const numbers = Math.floor(100000 + Math.random()*900000);
  return `${letters}-${numbers}`;
}

// Generate shipment and store in localStorage
function generateShipment() {
  const trackingNumber = generateTrackingCode();
  const shipment = {
    tracking_number: trackingNumber,
    sender: document.getElementById('newSender').value.trim(),
    receiver: document.getElementById('newReceiver').value.trim(),
    status: document.getElementById('newStatus').value.trim(),
    origin: document.getElementById('newOrigin').value.trim(),
    destination: document.getElementById('newDestination').value.trim(),
    expected_delivery: document.getElementById('newExpectedDelivery').value,
    extended_description: document.getElementById('newExtendedDescription').value.trim()
  };

  if (!shipment.sender || !shipment.receiver || !shipment.origin || !shipment.destination) {
    alert("Fill all required fields!");
    return;
  }

  let shipments = JSON.parse(localStorage.getItem('shipments') || '[]');
  shipments.push(shipment);
  localStorage.setItem('shipments', JSON.stringify(shipments));
  document.getElementById('newTrackingNumber').value = trackingNumber;
  alert(`Shipment generated: ${trackingNumber}`);
}

// Export shipments.json
function downloadShipments() {
  const shipments = JSON.parse(localStorage.getItem('shipments') || '[]');
  if (!shipments.length) return alert("No shipments available to download.");
  const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(shipments, null, 2));
  const dlAnchor = document.createElement('a');
  dlAnchor.setAttribute("href", dataStr);
  dlAnchor.setAttribute("download", "shipments.json");
  document.body.appendChild(dlAnchor);
  dlAnchor.click();
  dlAnchor.remove();
}
</script>

</body>
</html>
